{"version":3,"sources":["../src/optionstemplateselect.js"],"names":["define","$","ajax","init","change","val","call","methodname","args","id","done","data","obj","parseJSON","template","text","invisible","location","institution","address","is","bookingclosingtime","trigger","maxanswers","maxoverbooking","datebookingclosingtime","Date","getDate","getMonth","getFullYear","getHours","getMinutes","courseid","x","duration","coursestarttime","addtocalendar","datecoursestarttime","enrolmentstatus","datecourseendtime","courseendtime","html","description","pollurl","pollurlteachers","howmanyusers","removeafterminutes","notificationtext","disablebookingusers","beforebookedtext","beforecompletedtext","aftercompletedtext"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AJAX helper for the inline editing a value.\n *\n * This script is automatically included from template core/inplace_editable\n * It registers a click-listener on [data-inplaceeditablelink] link (the \"inplace edit\" icon),\n * then replaces the displayed value with an input field. On \"Enter\" it sends a request\n * to web service core_update_inplace_editable, which invokes the specified callback.\n * Any exception thrown by the web service (or callback) is displayed as an error popup.\n *\n * @module     mod_booking/optionstemplateselect\n * @package    mod_booking\n * @copyright  2019 Andraž Prinčič\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      4.5\n */\n\ndefine(['jquery', 'core/ajax'], function($, ajax) {\n\n    return {\n        init: function() {\n\n            // Put whatever you like here. $ is available\n            // to you as normal.\n            $(\"#id_optiontemplateid\").change(function() {\n                if ($(\"#id_optiontemplateid\").val() != '') {\n                    ajax\n                    .call([{\n                        methodname: 'mod_booking_optiontemplate',\n                        args: {\n                            id: $(\"#id_optiontemplateid\").val()\n                        },\n                        done: function(data) {\n                            var obj = $.parseJSON(data.template);\n\n                            // General\n                            $(\"#id_text\").val(obj.text);\n                            $(\"#id_invisible\").val(obj.invisible);\n                            $(\"#id_location\").val(obj.location);\n                            $(\"#id_institution\").val(obj.institution);\n                            $(\"#id_address\").val(obj.address);\n                            if ($('#id_limitanswers').is(':checked') != (obj.bookingclosingtime == 0 ? false : true)) {\n                                $(\"#id_limitanswers\").trigger('click');\n                            }\n                            $(\"#id_maxanswers\").val(obj.maxanswers);\n                            $(\"#id_maxoverbooking\").val(obj.maxoverbooking);\n                            if ($('#id_restrictanswerperiod').is(':checked') != (obj.bookingclosingtime == 0 ? false : true)) {\n                                $(\"#id_restrictanswerperiod\").trigger('click');\n                            }\n\n                            var datebookingclosingtime = new Date(obj.bookingclosingtime * 1000);\n                            $(\"#id_bookingclosingtime_day\").val(datebookingclosingtime.getDate());\n                            $(\"#id_bookingclosingtime_month\").val(datebookingclosingtime.getMonth() + 1);\n                            $(\"#id_bookingclosingtime_year\").val(datebookingclosingtime.getFullYear());\n                            $(\"#id_bookingclosingtime_hour\").val(datebookingclosingtime.getHours());\n                            $(\"#id_bookingclosingtime_minute\").val(datebookingclosingtime.getMinutes());\n\n                            $(\"#id_courseid\").val(obj.courseid);\n\n                            var x = obj.duration;\n                            switch (true) {\n                                case (x < 60):\n                                    $(\"#id_duration_number\").val(x);\n                                    $(\"#id_duration_timeunit\").val(1);\n                                    break;\n                                case (x < 3600):\n                                    $(\"#id_duration_number\").val(x / 60);\n                                    $(\"#id_duration_timeunit\").val(60);\n                                    break;\n                                case (x < 86400):\n                                    $(\"#id_duration_number\").val(x / 3600);\n                                    $(\"#id_duration_timeunit\").val(3600);\n                                    break;\n                                case (x < 604800):\n                                    $(\"#id_duration_number\").val(x / 86400);\n                                    $(\"#id_duration_timeunit\").val(86400);\n                                    break;\n                                default:\n                                    $(\"#id_duration_number\").val(x / 604800);\n                                    $(\"#id_duration_timeunit\").val(604800);\n                                    break;\n                            }\n\n                            if ($('#id_startendtimeknown').is(':checked') != (obj.coursestarttime == 0 ? false : true)) {\n                                $(\"#id_startendtimeknown\").trigger('click');\n                            }\n\n                            $(\"#id_addtocalendar\").val(obj.addtocalendar);\n\n                            var datecoursestarttime = new Date(obj.coursestarttime * 1000);\n                            $(\"#id_coursestarttime_day\").val(datecoursestarttime.getDate());\n                            $(\"#id_coursestarttime_month\").val(datecoursestarttime.getMonth() + 1);\n                            $(\"#id_coursestarttime_year\").val(datecoursestarttime.getFullYear());\n                            $(\"#id_coursestarttime_hour\").val(datecoursestarttime.getHours());\n                            $(\"#id_coursestarttime_minute\").val(datecoursestarttime.getMinutes());\n\n                            if ($('#id_enrolmentstatus').is(':checked') != (obj.enrolmentstatus == 0 ? false : true)) {\n                                $(\"#id_enrolmentstatus\").trigger('click');\n                            }\n\n                            var datecourseendtime = new Date(obj.courseendtime * 1000);\n                            $(\"#id_courseendtime_day\").val(datecourseendtime.getDate());\n                            $(\"#id_courseendtime_month\").val(datecourseendtime.getMonth() + 1);\n                            $(\"#id_courseendtime_year\").val(datecourseendtime.getFullYear());\n                            $(\"#id_courseendtime_hour\").val(datecourseendtime.getHours());\n                            $(\"#id_courseendtime_minute\").val(datecourseendtime.getMinutes());\n\n                            $(\"#id_descriptioneditable\").html(obj.description);\n                            $(\"#id_pollurl\").val(obj.pollurl);\n                            $(\"#id_pollurlteachers\").val(obj.pollurlteachers);\n                            $(\"#id_howmanyusers\").val(obj.howmanyusers);\n                            $(\"#id_removeafterminutes\").val(obj.removeafterminutes);\n\n                            // Advanced options.\n                            $(\"#id_notificationtexteditable\").html(obj.notificationtext);\n                            $(\"#id_disablebookingusers\").val(obj.disablebookingusers);\n\n                            // Booking option text depending on booking status.\n                            $(\"#id_beforebookedtexteditable\").html(obj.beforebookedtext);\n                            $(\"#id_beforecompletedtexteditable\").html(obj.beforecompletedtext);\n                            $(\"#id_aftercompletedtexteditable\").html(obj.aftercompletedtext);\n\n                            // Trigger clicks to fix autocomplete bugs.\n                            $(\"#fitem_id_location .form-autocomplete-downarrow\").trigger('click');\n                            $(\"#fitem_id_institution .form-autocomplete-downarrow\").trigger('click');\n                            $(\"#fitem_id_courseid .badge\").trigger('click');\n                            $(\"#id_optiontemplateid\").trigger('click');\n\n                            // A little hack to close open menus.\n                            $(\"#fitem_id_courseendtime .icon\").trigger('click');\n                            $(\"#fitem_id_courseendtime .icon\").trigger('click');\n\n                        }\n                    }], true);\n                }\n            });\n        }\n    };\n});"],"file":"optionstemplateselect.min.js"}